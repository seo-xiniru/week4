<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>여름 타임캡슐</title>
<style>
  @font-face {
    font-family: 'YunChorokwoosanEoriniMinguk';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2408@1.0/YoonChildfundkoreaMinGuk.woff2') format('woff2');
    font-weight: normal;
    font-display: swap;
  }

  html {font-family: 'YunChorokwoosanEoriniMinguk', sans-serif;}

  body {
    margin: 0; height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background: #222; color: white;
  }

  body::before {
    content: "";
    position: fixed; top: 0;
    left: 0; width: 100%;
    height: 100%;
    background: url('bg.jpg') center/cover no-repeat;
    opacity: 0.6; z-index: -1;            
  }

  .box {
    position: relative;
    width: 300px; height: 300px;
    border: 4px solid #ffffff;
    border-radius: 20px;
    margin-bottom: 20px;
    overflow: hidden;
    background: rgba(255,255,255,0.05);
  }

  .fixed {
    position: absolute;
    font-weight: bold;
    font-size: 30px;
    pointer-events: none;
  }

  .fade {
    position: absolute;
    font-weight: bold;
    font-size: 30px;
    pointer-events: none;
    animation: floatFade 2s forwards;
  }

  @keyframes floatFade {
    0% { opacity: 1; transform: translateY(0px); }
    100% { opacity: 0; transform: translateY(-20px); }
  }

  .controls {
    display: flex; gap: 10px; margin-top: 10px;
  }

  button { padding: 5px 10px; font-size: 16px; cursor: pointer; }
  #message {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  font-size: 20px; text-align: center;
  color: white; pointer-events: none;
  }

</style>
</head>
<body>

<p style="font-size: 30px;">타임캡슐에 여름을 담아 묻어봅시다.</p>

<div class="box" id="box">
  <div id="message"></div>
</div>

<div class="controls">
  <input type="date" id="dateInput">
  <button id="buryBtn">묻어두기</button>
</div>

<script>
let data = "Hey summer, 인사할 때야 서늘한 바람이 불어 어느덧 끝 무렵에 다다른 줄도 모르고 꼭 오늘을 닮은 밤 내게 주었던 말 못 잊을 것 같아 난 우리 뜨겁게 사랑했던 이름 없는 모든 날 안녕, 오랜 내 여름아, 뒤돌아보지 마 어려운 말 없이 이대로 보내 주자 멀리 달려가는 우리를 따라오던 밤 아무 예고 없이 시작된 여름날처럼 My summer, 그리울 거야 따가운 그을림까지도 Sweet sorrow, 이유를 모르는 눈물이 고이고 이 계절에 사랑한 건 얼룩을 남기니까 오래도록 안녕, 오랜 내 여름아, 뒤돌아보지 마 어려운 말 없이 이대로 보내 주자 멀리 달려가는 우리를 뒤따라오던 밤 아래 그 더위까지 잘 가, 내 오랜 여름아, 머뭇거리지 마 마지막 인사 대신 그저 널 안고 싶지만 멈춰버린 하늘에 별이 달리는 밤 내겐 영원 같았던 우리를 닫는다 우리를 닫는다 (향긋한 웃음으로 일렁이는 목소리로, oh) Bye summer, 인사할 때야 서늘한 바람이";
let lyrics = data.split(" ");
let i = 0;
let lastTime = 0;
const box = document.getElementById("box");

let boxWords = [];

function createWord(x, y, text, color) {
  const word = document.createElement("div");
  word.className = 'fixed';
  word.textContent = text;
  word.style.color = color;
  word.style.left = x + "px";
  word.style.top = y + "px";
  box.appendChild(word);

  boxWords.push({
    el: word,
    x: x,
    y: y,
    vy: 0,
    removed: false
  });
}

window.onmousemove = function(e) {
  let now = Date.now();
  if(now - lastTime < 200) return;
  lastTime = now;

  const boxRect = box.getBoundingClientRect();
  const mouseX = e.clientX - boxRect.left;
  const mouseY = e.clientY - boxRect.top;

  let insideBox = mouseX >= 0 && mouseX <= box.clientWidth &&
                  mouseY >= 0 && mouseY <= box.clientHeight;

  const text = lyrics[i];
  i = (i + 1) % lyrics.length;

  const hue = Math.floor(Math.random() * 360);
  const color = `hsl(${hue},70%,80%)`;

  if(insideBox) {
    // 박스 안 글자
    createWord(mouseX, mouseY, text, color);
  } else {
    const word = document.createElement("div");
    word.className = 'fade';
    word.textContent = text;
    word.style.color = color;
    word.style.left = e.clientX + "px";
    word.style.top = e.clientY + "px";
    document.body.appendChild(word);
    setTimeout(() => word.remove(), 2000);
  }
}

function animate() {
  const gravity = 0.5;

  for(let i=0; i<boxWords.length; i++){
    const w = boxWords[i];
    if(w.removed) continue;

    w.vy += gravity;
    w.y += w.vy;

    if(w.y + 30 > box.clientHeight){
      w.y = box.clientHeight - 30;
      w.vy *= -0.3;
      w.x += (Math.random()-0.5)*2;
    }

    for(let j=0; j<i; j++){
      const other = boxWords[j];
      if(other.removed) continue;
      if(Math.abs(w.x - other.x)<30 && Math.abs(w.y - other.y)<30){
        w.y = other.y - 30;
        w.vy = 0;
      }
    }

    w.el.style.top = w.y + "px";
    w.el.style.left = w.x + "px";
  }

  requestAnimationFrame(animate);
}

animate();

document.getElementById("buryBtn").addEventListener("click", () => {
  const dateValue = document.getElementById("dateInput").value || '선택한 날짜';

  boxWords.forEach(w => {
    if(w.removed) return;
    w.el.style.transition = "top 2s ease, opacity 2s ease";
    w.el.style.top = (w.y - 50) + "px";
    w.el.style.opacity = 0;
    w.removed = true;
    setTimeout(() => w.el.remove(), 2000);
  });

  setTimeout(() => {
    document.getElementById("message").textContent = `${dateValue}를 타임캡슐에 묻었습니다`;
  }, 2000);
});
</script>

</body>
</html>
